<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ระบบจัดการงานและกำหนดส่ง</title>
    <style>
        * {
            box-sizing: border-box;
            font-family: 'Sarabun', sans-serif;
        }
        body {
            margin: 0;
            padding: 0;
            background-color: #f0f2f5;
            min-height: 100vh;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        .card {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        .login-form {
            max-width: 400px;
            margin: 50px auto;
        }
        .form-group {
            margin-bottom: 15px;
        }
        input, textarea {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 16px;
        }
        button {
            background: #4CAF50;
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            transition: background 0.3s;
        }
        button:hover {
            background: #45a049;
        }
        .course-item {
            border-bottom: 1px solid #eee;
            padding: 20px;
            margin-bottom: 20px;
        }
        .deadline {
            color: #e74c3c;
            font-weight: bold;
            margin-top: 10px;
        }
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 20px;
            background: white;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .login-button {
            background: #2196F3;
        }
        .login-button:hover {
            background: #1976D2;
        }
        .logout-button {
            background: #f44336;
        }
        .logout-button:hover {
            background: #d32f2f;
        }
        .section-title {
            background: #1976D2;
            color: white;
            padding: 10px 20px;
            margin: 15px 0;
            border-radius: 4px;
        }
        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            .card {
                padding: 15px;
            }
            input, textarea, button {
                font-size: 14px;
            }
            .header {
                flex-direction: column;
                text-align: center;
                gap: 10px;
            }
        }
        .course-content {
            white-space: pre-line;
            line-height: 1.6;
        }
    </style>
</head>
<body>

<div class="header">
    <h1>ระบบจัดการงานและกำหนดส่ง</h1>
    <div>
        <button class="login-button" onclick="showLogin()" id="loginButton">เข้าสู่ระบบ</button>
        <button class="logout-button" onclick="logout()" id="logoutButton" style="display: none;">ออกจากระบบ</button>
    </div>
</div>

<!-- หน้า Login -->
<div class="login-form card" id="loginForm" style="display: none;">
    <h2>เข้าสู่ระบบสำหรับผู้ดูแล</h2>
    <div class="form-group">
        <label>ชื่อผู้ใช้:</label>
        <input type="text" id="username">
    </div>
    <div class="form-group">
        <label>รหัสผ่าน:</label>
        <input type="password" id="password">
    </div>
    <button onclick="login()">เข้าสู่ระบบ</button>
</div>

<!-- หน้าแสดงรายการงาน -->
<div class="container" id="publicView">
    <div id="courseList"></div>
</div>

<!-- หน้าแอดมิน -->
<div class="container card" id="adminPanel" style="display: none;">
    <h2>จัดการรายการงาน</h2>
    <div class="form-group">
        <label>ชื่อวิชา:</label>
        <input type="text" id="courseName">
    </div>
    <div class="form-group">
        <label>รายละเอียด:</label>
        <textarea id="courseDetails" rows="6" placeholder="เว้น 2 บรรทัดเพื่อขึ้นหัวข้อใหม่"></textarea>
    </div>
    <div class="form-group">
        <label>กำหนดส่ง:</label>
        <input type="datetime-local" id="deadline">
    </div>
    <button onclick="addCourse()">เพิ่มรายการ</button>
</div>

<script>
// ข้อมูลผู้ดูแลระบบ
const ADMIN_USERNAME = 'admin';
const ADMIN_PASSWORD = 'password123';

// โหลดข้อมูลจาก localStorage
let courses = JSON.parse(localStorage.getItem('courses')) || [];

// ตรวจสอบสถานะการล็อกอิน
function checkLoginStatus() {
    const isLoggedIn = localStorage.getItem('isLoggedIn') === 'true';
    if (isLoggedIn) {
        showAdminPanel();
    }
}

function showLogin() {
    document.getElementById('loginForm').style.display = 'block';
    document.getElementById('loginButton').style.display = 'none';
}

function login() {
    const username = document.getElementById('username').value;
    const password = document.getElementById('password').value;
    
    if (username === ADMIN_USERNAME && password === ADMIN_PASSWORD) {
        localStorage.setItem('isLoggedIn', 'true');
        showAdminPanel();
        alert('เข้าสู่ระบบสำเร็จ');
    } else {
        alert('ชื่อผู้ใช้หรือรหัสผ่านไม่ถูกต้อง');
    }
}

function showAdminPanel() {
    document.getElementById('loginForm').style.display = 'none';
    document.getElementById('adminPanel').style.display = 'block';
    document.getElementById('loginButton').style.display = 'none';
    document.getElementById('logoutButton').style.display = 'inline-block';
}

function logout() {
    localStorage.removeItem('isLoggedIn');
    document.getElementById('adminPanel').style.display = 'none';
    document.getElementById('loginButton').style.display = 'inline-block';
    document.getElementById('logoutButton').style.display = 'none';
}

function addCourse() {
    const courseName = document.getElementById('courseName').value;
    const courseDetails = document.getElementById('courseDetails').value;
    const deadline = document.getElementById('deadline').value;
    
    if (!courseName || !courseDetails || !deadline) {
        alert('กรุณากรอกข้อมูลให้ครบ');
        return;
    }
    
    const course = {
        name: courseName,
        details: courseDetails,
        deadline: deadline,
        id: Date.now()
    };
    
    courses.push(course);
    saveCourses();
    updateCourseList();
    clearForm();
}

function updateCourseList() {
    const courseList = document.getElementById('courseList');
    courseList.innerHTML = '';
    
    courses.sort((a, b) => new Date(a.deadline) - new Date(b.deadline));
    
    let currentDate = null;
    
    courses.forEach(course => {
        const courseDate = new Date(course.deadline).toLocaleDateString('th-TH');
        
        if (currentDate !== courseDate) {
            currentDate = courseDate;
            const dateHeader = document.createElement('h2');
            dateHeader.className = 'section-title';
            dateHeader.textContent = `กำหนดส่งวันที่ ${courseDate}`;
            courseList.appendChild(dateHeader);
        }
        
        const courseElement = document.createElement('div');
        courseElement.className = 'course-item card';
        
        // แยกเนื้อหาตามการเว้น 2 บรรทัด
        const sections = course.details.split('\n\n');
        const formattedDetails = sections.map((section, index) => 
            index === 0 ? section : `<h3>${section}</h3>`
        ).join('');
        
        courseElement.innerHTML = `
            <h2>${course.name}</h2>
            <div class="course-content">${formattedDetails}</div>
            <p class="deadline">กำหนดส่ง: ${new Date(course.deadline).toLocaleString('th-TH')}</p>
            ${isAdmin() ? `<button onclick="deleteCourse(${course.id})">ลบรายการ</button>` : ''}
        `;
        courseList.appendChild(courseElement);
    });
}

function deleteCourse(id) {
    if (confirm('คุณต้องการลบรายการนี้ใช่หรือไม่?')) {
        courses = courses.filter(course => course.id !== id);
        saveCourses();
        updateCourseList();
    }
}

function saveCourses() {
    localStorage.setItem('courses', JSON.stringify(courses));
}

function clearForm() {
    document.getElementById('courseName').value = '';
    document.getElementById('courseDetails').value = '';
    document.getElementById('deadline').value = '';
}

function isAdmin() {
    return localStorage.getItem('isLoggedIn') === 'true';
}

// เริ่มต้นแสดงผล
checkLoginStatus();
updateCourseList();
</script>

</body>
</html>
